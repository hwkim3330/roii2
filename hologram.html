<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROii2 - Holographic Display</title>
    <script src="libs/three.min.js"></script>
    <script src="libs/OrbitControls.js"></script>
    <script src="libs/GLTFLoader.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Rajdhani', sans-serif;
            background: #000;
            overflow: hidden;
            color: #00d4ff;
        }
        #canvas3d { width: 100vw; height: 100vh; }

        /* Holographic scan lines */
        .holo-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            background:
                repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(0, 212, 255, 0.03) 3px, rgba(0, 212, 255, 0.03) 4px);
            animation: scan 8s linear infinite;
            z-index: 100;
        }
        @keyframes scan {
            0% { background-position: 0 0; }
            100% { background-position: 0 100vh; }
        }

        .flicker {
            animation: flicker 0.1s infinite;
        }
        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.98; }
        }

        .holo-frame {
            position: absolute;
            border: 2px solid rgba(0, 212, 255, 0.5);
            pointer-events: none;
        }
        .holo-frame.outer {
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            border-radius: 20px;
        }
        .holo-frame.inner {
            top: 25px; left: 25px; right: 25px; bottom: 25px;
            border-radius: 15px;
            border-style: dashed;
            opacity: 0.3;
        }

        .title-holo {
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 101;
        }
        .title-holo h1 {
            font-size: 42px;
            font-weight: 700;
            letter-spacing: 10px;
            color: transparent;
            background: linear-gradient(180deg, #00d4ff, #0066ff);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
        }
        .title-holo .subtitle {
            font-size: 14px;
            letter-spacing: 5px;
            color: #0099cc;
            margin-top: 5px;
        }

        .holo-panel {
            position: absolute;
            background: linear-gradient(135deg, rgba(0, 50, 80, 0.4), rgba(0, 20, 40, 0.6));
            border: 1px solid rgba(0, 212, 255, 0.4);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            z-index: 101;
        }
        .holo-panel::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00d4ff, transparent);
        }

        .info-panel {
            top: 130px;
            left: 40px;
            width: 250px;
        }
        .info-panel h3 {
            font-size: 12px;
            letter-spacing: 3px;
            margin-bottom: 15px;
            color: #00d4ff;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 212, 255, 0.2);
            font-size: 13px;
        }
        .info-row span:first-child { color: #0099cc; }
        .info-row span:last-child { color: #00d4ff; font-weight: 600; }

        .status-panel {
            top: 130px;
            right: 40px;
            width: 280px;
        }
        .status-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(0, 212, 255, 0.05);
            border-radius: 8px;
            border-left: 3px solid #00d4ff;
        }
        .status-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #00d4ff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        .status-info { flex: 1; }
        .status-name { font-size: 12px; color: #0099cc; }
        .status-value { font-size: 18px; font-weight: 700; }

        .bottom-stats {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 30px;
            z-index: 101;
        }
        .stat-hex {
            width: 100px;
            height: 115px;
            background: rgba(0, 50, 80, 0.4);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: none;
            position: relative;
        }
        .stat-hex::before {
            content: '';
            position: absolute;
            inset: 2px;
            background: rgba(0, 0, 0, 0.5);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
        }
        .stat-hex .value {
            font-size: 28px;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }
        .stat-hex .label {
            font-size: 9px;
            letter-spacing: 1px;
            color: #0099cc;
            position: relative;
            z-index: 1;
        }

        .nav-holo {
            position: absolute;
            bottom: 50px;
            right: 40px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 101;
        }
        .nav-holo a {
            padding: 10px 20px;
            background: rgba(0, 50, 80, 0.4);
            border: 1px solid rgba(0, 212, 255, 0.4);
            border-radius: 5px;
            color: #00d4ff;
            text-decoration: none;
            font-size: 11px;
            letter-spacing: 2px;
            transition: all 0.3s;
            text-align: center;
        }
        .nav-holo a:hover, .nav-holo a.active {
            background: rgba(0, 212, 255, 0.3);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }

        .corner-deco {
            position: absolute;
            width: 60px;
            height: 60px;
            border: 2px solid rgba(0, 212, 255, 0.5);
            z-index: 101;
        }
        .corner-deco.tl { top: 40px; left: 40px; border-right: none; border-bottom: none; }
        .corner-deco.tr { top: 40px; right: 40px; border-left: none; border-bottom: none; }
        .corner-deco.bl { bottom: 40px; left: 40px; border-right: none; border-top: none; }
        .corner-deco.br { bottom: 40px; right: 40px; border-left: none; border-top: none; }
    </style>
</head>
<body>
    <div id="canvas3d"></div>
    <div class="holo-overlay flicker"></div>
    <div class="holo-frame outer"></div>
    <div class="holo-frame inner"></div>

    <div class="corner-deco tl"></div>
    <div class="corner-deco tr"></div>
    <div class="corner-deco bl"></div>
    <div class="corner-deco br"></div>

    <div class="title-holo">
        <h1>ROii2</h1>
        <div class="subtitle">HOLOGRAPHIC NETWORK INTERFACE</div>
    </div>

    <div class="holo-panel info-panel">
        <h3>// SYSTEM DATA</h3>
        <div class="info-row"><span>ARCHITECTURE</span><span>ZONE TSN</span></div>
        <div class="info-row"><span>CONTROLLER</span><span>LAN9692 ×3</span></div>
        <div class="info-row"><span>CENTRAL HPC</span><span>ACU_IT</span></div>
        <div class="info-row"><span>BACKBONE</span><span>10 Gbps</span></div>
        <div class="info-row"><span>SENSOR LINKS</span><span>1 Gbps</span></div>
        <div class="info-row"><span>LATENCY</span><span>&lt;2 μs</span></div>
        <div class="info-row"><span>TSN STD</span><span>802.1Qbv</span></div>
    </div>

    <div class="holo-panel status-panel">
        <h3 style="font-size:12px; letter-spacing:3px; margin-bottom:15px;">// SENSOR STATUS</h3>
        <div class="status-item">
            <div class="status-icon">◉</div>
            <div class="status-info">
                <div class="status-name">LiDAR ARRAY</div>
                <div class="status-value">4 ONLINE</div>
            </div>
        </div>
        <div class="status-item">
            <div class="status-icon">◎</div>
            <div class="status-info">
                <div class="status-name">CAMERA ARRAY</div>
                <div class="status-value">8 ONLINE</div>
            </div>
        </div>
        <div class="status-item">
            <div class="status-icon">◈</div>
            <div class="status-info">
                <div class="status-name">RADAR ARRAY</div>
                <div class="status-value">5 ONLINE</div>
            </div>
        </div>
    </div>

    <div class="bottom-stats">
        <div class="stat-hex">
            <div class="value" id="devices">0</div>
            <div class="label">NODES</div>
        </div>
        <div class="stat-hex">
            <div class="value" id="links">0</div>
            <div class="label">LINKS</div>
        </div>
        <div class="stat-hex">
            <div class="value" id="bw">0</div>
            <div class="label">GBPS</div>
        </div>
    </div>

    <div class="nav-holo">
        <a href="index.html">NETWORK</a>
        <a href="hologram.html" class="active">HOLOGRAM</a>
        <a href="wireframe.html">TRON</a>
        <a href="blueprint.html">BLUEPRINT</a>
    </div>

    <script>
    // === THREE.JS SETUP ===
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x000510);

    const camera = new THREE.PerspectiveCamera(55, window.innerWidth / window.innerHeight, 0.1, 1000);
    camera.position.set(55, 45, 55);

    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.getElementById('canvas3d').appendChild(renderer.domElement);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.autoRotate = true;
    controls.autoRotateSpeed = 0.6;

    // Holographic lighting
    scene.add(new THREE.AmbientLight(0x00d4ff, 0.3));
    const light1 = new THREE.PointLight(0x00d4ff, 1, 200);
    light1.position.set(0, 50, 0);
    scene.add(light1);

    // Holographic base platform
    const platformGeo = new THREE.CylinderGeometry(35, 40, 2, 64);
    const platformMat = new THREE.MeshBasicMaterial({
        color: 0x00d4ff,
        transparent: true,
        opacity: 0.1
    });
    const platform = new THREE.Mesh(platformGeo, platformMat);
    platform.position.y = -2;
    scene.add(platform);

    // Rotating rings
    const rings = [];
    for (let i = 0; i < 3; i++) {
        const ringGeo = new THREE.TorusGeometry(45 + i * 10, 0.2, 8, 64);
        const ringMat = new THREE.MeshBasicMaterial({
            color: 0x00d4ff,
            transparent: true,
            opacity: 0.2 - i * 0.05
        });
        const ring = new THREE.Mesh(ringGeo, ringMat);
        ring.rotation.x = Math.PI / 2;
        ring.position.y = -1;
        scene.add(ring);
        rings.push(ring);
    }

    // Vertical scan line
    const scanGeo = new THREE.PlaneGeometry(100, 0.5);
    const scanMat = new THREE.MeshBasicMaterial({
        color: 0x00d4ff,
        transparent: true,
        opacity: 0.3,
        side: THREE.DoubleSide
    });
    const scanLine = new THREE.Mesh(scanGeo, scanMat);
    scanLine.rotation.y = Math.PI / 2;
    scene.add(scanLine);

    // === STATE ===
    const vehicleGroup = new THREE.Group();
    scene.add(vehicleGroup);

    const devices = new Map();
    const connections = [];
    let deviceCounter = 1;

    const templates = {
        lan9692: { color: 0x00d4ff, size: [4, 2, 4] },
        hpc: { color: 0xff00aa, size: [5, 2.5, 5] },
        camera: { color: 0xffaa00, size: [0.8, 0.8, 0.8] },
        lidar: { color: 0x00ff88, size: [1.2, 1.2, 1.2] },
        radar: { color: 0xaa00ff, size: [1.2, 1.2, 1.2] }
    };

    // === VEHICLE (Holographic style) ===
    function createVehicle() {
        const loader = new THREE.GLTFLoader();
        loader.load('./roii.glb', (gltf) => {
            const model = gltf.scene;
            const box = new THREE.Box3().setFromObject(model);
            const size = box.getSize(new THREE.Vector3());
            const center = box.getCenter(new THREE.Vector3());
            const scale = 40 / Math.max(size.x, size.y, size.z);
            model.scale.set(scale, scale, scale);
            model.position.set(-center.x, -center.y + size.y * scale * 0.5, -center.z);

            model.traverse((child) => {
                if (child.isMesh) {
                    child.material = new THREE.MeshBasicMaterial({
                        color: 0x00d4ff,
                        wireframe: true,
                        transparent: true,
                        opacity: 0.4
                    });
                }
            });
            vehicleGroup.add(model);
        });
    }

    // === DEVICE ===
    function addDevice(type, position, label) {
        const t = templates[type];
        const id = `device-${deviceCounter++}`;
        const group = new THREE.Group();

        // Holographic cube
        const geo = new THREE.BoxGeometry(...t.size);
        const mat = new THREE.MeshBasicMaterial({
            color: t.color,
            transparent: true,
            opacity: 0.3
        });
        const mesh = new THREE.Mesh(geo, mat);
        group.add(mesh);

        // Wireframe
        const edges = new THREE.EdgesGeometry(geo);
        const lineMat = new THREE.LineBasicMaterial({ color: t.color });
        const wireframe = new THREE.LineSegments(edges, lineMat);
        group.add(wireframe);

        // Holographic glow
        const glowGeo = new THREE.SphereGeometry(t.size[0] * 0.8, 16, 16);
        const glowMat = new THREE.MeshBasicMaterial({
            color: t.color,
            transparent: true,
            opacity: 0.15
        });
        const glow = new THREE.Mesh(glowGeo, glowMat);
        group.add(glow);

        group.position.copy(position);
        vehicleGroup.add(group);

        const device = { id, type, label, position: position.clone(), mesh: group };
        devices.set(id, device);
        return device;
    }

    function createConnection(from, to) {
        const isBackbone = (from.type === 'lan9692' && to.type === 'lan9692') || from.type === 'hpc' || to.type === 'hpc';
        const color = isBackbone ? 0xff00aa : 0x00d4ff;

        const points = [from.position.clone(), to.position.clone()];
        const geo = new THREE.BufferGeometry().setFromPoints(points);
        const mat = new THREE.LineBasicMaterial({
            color: color,
            transparent: true,
            opacity: 0.6
        });
        const line = new THREE.Line(geo, mat);
        vehicleGroup.add(line);

        // Data pulse
        const pulseGeo = new THREE.SphereGeometry(0.3, 8, 8);
        const pulseMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
        const pulse = new THREE.Mesh(pulseGeo, pulseMat);
        vehicleGroup.add(pulse);

        connections.push({
            from, to, line, pulse,
            t: Math.random(),
            bandwidth: isBackbone ? '10G' : '1G'
        });
    }

    // === LOAD SCENARIO ===
    function loadScenario() {
        createVehicle();

        const acuIT = addDevice('hpc', new THREE.Vector3(0, 4, 0), 'ACU_IT');
        const frontL = addDevice('lan9692', new THREE.Vector3(-3.5, 4, 10), 'FRONT-L');
        const frontR = addDevice('lan9692', new THREE.Vector3(3.5, 4, 10), 'FRONT-R');
        const rear = addDevice('lan9692', new THREE.Vector3(0, 4, -10), 'REAR');

        [[-8.5, 10, 16.2], [8.5, 10, 16.2], [0, 5.5, 18.5], [0, 5.5, -18.5]].forEach(p =>
            addDevice('lidar', new THREE.Vector3(...p), 'LIDAR'));

        [[0, 10.5, 18.5], [0.6, 10.5, 18.5], [-0.6, 10.5, 18.5], [-8.5, 11, 16.5], [8.5, 11, 16.5], [-8.5, 11, 15.9], [8.5, 11, 15.9], [0, 9, -18.5]].forEach(p =>
            addDevice('camera', new THREE.Vector3(...p), 'CAM'));

        [[0, 7, 18.5], [-7, 6.5, 17.5], [7, 6.5, 17.5], [-7, 6.5, -18], [7, 6.5, -18]].forEach(p =>
            addDevice('radar', new THREE.Vector3(...p), 'RADAR'));

        createConnection(frontL, acuIT);
        createConnection(frontR, acuIT);
        createConnection(rear, acuIT);
        createConnection(frontL, frontR);

        devices.forEach(d => {
            if (['lidar', 'camera', 'radar'].includes(d.type)) {
                const zone = d.position.z > 0 ? (d.position.x < 0 ? frontL : frontR) : rear;
                createConnection(zone, d);
            }
        });

        document.getElementById('devices').textContent = devices.size;
        document.getElementById('links').textContent = connections.length;
        let bw = 0;
        connections.forEach(c => bw += c.bandwidth === '10G' ? 10 : 1);
        document.getElementById('bw').textContent = bw;
    }

    // === ANIMATION ===
    let time = 0;
    function animate() {
        requestAnimationFrame(animate);
        time += 0.016;

        controls.update();

        // Rotate rings
        rings.forEach((ring, i) => {
            ring.rotation.z = time * (0.1 + i * 0.05) * (i % 2 ? 1 : -1);
        });

        // Scan line
        scanLine.position.y = Math.sin(time) * 30;

        // Animate pulses
        connections.forEach(conn => {
            conn.t += 0.012;
            if (conn.t > 1) conn.t = 0;
            const pos = conn.from.position.clone().lerp(conn.to.position, conn.t);
            conn.pulse.position.copy(pos);
        });

        // Platform rotation
        platform.rotation.y = time * 0.1;

        renderer.render(scene, camera);
    }

    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });

    loadScenario();
    animate();
    </script>
</body>
</html>
